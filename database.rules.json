{
  "rules": {
    "tournaments": {
      ".read": true,
      "$tournamentId": {
       
        ".write": "!data.exists() || (data.exists() && data.child('expiresAt').val() > now)",

        
        ".validate": "(!data.exists() && newData.hasChildren(['id', 'createdAt', 'expiresAt', 'players', 'schedule', 'playerStats']) && newData.child('id').val() === $tournamentId) || (data.exists() && newData.child('id').val() === data.child('id').val() && newData.child('createdAt').val() === data.child('createdAt').val())",

        "id": {
          ".validate": "newData.isString()"
        },
        "createdAt": {
          ".validate": "newData.isNumber()"
        },
        "expiresAt": {
          ".validate": "newData.isNumber()"
        },
        "players": {
          ".validate": "newData.val() === null || newData.hasChildren()"
        },
        "schedule": {
          ".validate": "newData.val() === null || newData.hasChildren()"
        },
        "playerStats": {
          ".validate": "newData.val() === null || newData.hasChildren()"
        },
        
        "$other": { ".validate": true }
      }
    }
  }
}
